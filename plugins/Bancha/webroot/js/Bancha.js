var TraceKit={};TraceKit.report=(function(){var d=[],c=null,h=null;function b(i){d.push(i)}function g(k){for(var j=d.length-1;j>=0;--j){if(d[j]===k){d.splice(j,1)}}}function e(j){var m=null;for(var l in d){if(d.hasOwnProperty(l)){try{d[l](j)}catch(k){m=k}}}if(m){throw m}}var f=window.onerror;window.onerror=function(l,k,m){var i=null;if(h){TraceKit.computeStackTrace.augmentStackTraceWithInitialElement(h,k,m,l);i=h;h=null;c=null}else{var j={url:k,line:m};j.func=TraceKit.computeStackTrace.guessFunctionName(j.url,j.line);j.context=TraceKit.computeStackTrace.gatherContext(j.url,j.line);i={mode:"onerror",message:l,stack:[j]}}e(i);if(f){return f.apply(this,arguments)}return false};function a(j){if(h){if(c===j){return}else{var k=h;h=null;c=null;e(k)}}var i=TraceKit.computeStackTrace(j);h=i;c=j;window.setTimeout(function(){if(c===j){h=null;c=null;e(i)}},(i.incomplete?2000:0));throw j}a.subscribe=b;a.unsubscribe=g;return a}());TraceKit.computeStackTrace=(function(){var k=false,g={};function b(s){try{if(XMLHttpRequest===undefined){XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(v){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(v){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(v){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(v){}throw new Error("No XHR.")}}var t=new XMLHttpRequest();t.open("GET",s,false);t.send("");return t.responseText}catch(u){return""}}function j(s){if(!g.hasOwnProperty(s)){var t=b(s);g[s]=t.length?t.split("\n"):[]}return g[s]}function p(t,v){var z=/function ([^(]*)\(([^)]*)\)/,w=/['"]?([0-9A-Za-z$_]+)['"]?\s*[:=]\s*(function|eval|new Function)/,A="",y=10,s=j(t),u;if(!s.length){return"?"}for(var x=0;x<y;++x){A=s[v-x]+A;if(A!==undefined){if((u=w.exec(A))){return u[1]}else{if((u=z.exec(A))){return u[1]}}}}return"?"}function r(u,s){var x=j(u),w=[],y=false;if(!x.length){return null}s-=1;for(var v=s-2,t=s+2;v<t;++v){w.push(x[v]);if(x[v]!==undefined){y=true}}return y?w:null}function c(s){return s.replace(/[\-\[\]{}()*+?.,\\\^$|#]/g,"\\$&")}function n(s){return c(s).replace("<","(?:<|&lt;)").replace(">","(?:>|&gt;)").replace("&","(?:&|&amp;)").replace('"','(?:"|&quot;)').replace(/\s+/g,"\\s+")}function e(v,x){var w,s;for(var u=0,t=x.length;u<t;++u){if((w=j(x[u])).length){w=w.join("\n");if((s=v.exec(w))){return{url:x[u],line:w.substring(0,s.index).split("\n").length,column:s.index-w.lastIndexOf("\n",s.index)-1}}}}return null}function q(v,u,t){var x=j(u),w=new RegExp("\\b"+c(v)+"\\b"),s;t-=1;if(x&&x.length>t&&(s=w.exec(x[t]))){return s.index}return null}function l(x){var D=[window.location.href],y=document.getElementsByTagName("script"),B,v=""+x,u=/^function(?:\s+([\w$]+))?\s*\(([\w\s,]*)\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,w=/^function on([\w$]+)\s*\(event\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,F,z,G;for(var A=0;A<y.length;++A){var E=y[A];if(E.src){D.push(E.src)}}if(!(z=u.exec(v))){F=new RegExp(c(v).replace(/\s+/g,"\\s+"))}else{var t=z[1]?"\\s+"+z[1]:"",C=z[2].split(",").join("\\s*,\\s*");B=c(z[3]).replace(/;$/,";?").replace(/\s+/g,"\\s+");F=new RegExp("function"+t+"\\s*\\(\\s*"+C+"\\s*\\)\\s*{\\s*"+B+"\\s*}")}if((G=e(F,D))){return G}if((z=w.exec(v))){var s=z[1];B=n(z[2]);F=new RegExp("on"+s+"=[\\'\"]\\s*"+B+"\\s*[\\'\"]","i");if((G=e(F,D[0]))){return G}F=new RegExp(B);if((G=e(F,D))){return G}}return null}function m(z){if(!z.stack){return null}var y=/^\s*at (\S+) \(((?:file|http):.*?):(\d+)(?::(\d+))?\)\s*$/i,s=/^\s*(\S*)(?:\((.*?)\))?@((?:file|http).*?):(\d+)(?::(\d+))?\s*$/i,B=z.stack.split("\n"),A=[],v,x,t=/^(.*) is undefined$/.exec(z.message);for(var w=0,u=B.length;w<u;++w){if((v=s.exec(B[w]))){x={url:v[3],func:v[1],args:v[2]?v[2].split(","):"",line:+v[4],column:v[5]?+v[5]:null}}else{if((v=y.exec(B[w]))){x={url:v[2],func:v[1],line:+v[3],column:v[4]?+v[4]:null}}else{continue}}if(!x.func&&x.line){x.func=p(x.url,x.line)}if(x.line){x.context=r(x.url,x.line)}A.push(x)}if(A[0]&&A[0].line&&!A[0].column&&t){A[0].column=q(t[1],A[0].url,A[0].line)}if(!A.length){return null}return{mode:"stack",name:z.name,message:z.message,stack:A}}function i(x){var z=x.stacktrace;var w=/ line (\d+), column (\d+) in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\) in (.*):\s*$/i,B=z.split("\n"),y=[],s;for(var v=0,t=B.length;v<t;v+=2){if((s=w.exec(B[v]))){var u={line:+s[1],column:+s[2],func:s[3]||s[4],args:s[5]?s[5].split(","):[],url:s[6]};if(!u.func&&u.line){u.func=p(u.url,u.line)}if(u.line){try{u.context=r(u.url,u.line)}catch(A){}}if(!u.context){u.context=[B[v+1]]}y.push(u)}}if(!y.length){return null}return{mode:"stacktrace",name:x.name,message:x.message,stack:y}}function f(K){var u=K.message.split("\n");if(u.length<4){return null}var w=/^\s*Line (\d+) of linked script ((?:file|http)\S+)(?:: in function (\S+))?\s*$/i,v=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|http)\S+)(?:: in function (\S+))?\s*$/i,s=/^\s*Line (\d+) of function script\s*$/i,B=[],y=document.getElementsByTagName("script"),J=[],F,H,I,G;for(H in y){if(y.hasOwnProperty(H)&&!y[H].src){J.push(y[H])}}for(H=2,I=u.length;H<I;H+=2){var L=null;if((F=w.exec(u[H]))){L={url:F[2],func:F[3],line:+F[1]}}else{if((F=v.exec(u[H]))){L={url:F[3],func:F[4]};var t=(+F[1]);var M=J[F[2]-1];if(M){G=j(L.url);if(G){G=G.join("\n");var A=G.indexOf(M.innerText);if(A>=0){L.line=t+G.substring(0,A).split("\n").length}}}}else{if((F=s.exec(u[H]))){var z=window.location.href.replace(/#.*$/,""),C=F[1];var E=new RegExp(n(u[H+1]));G=e(E,[z]);L={url:z,line:G?G.line:C,func:""}}}}if(L){if(!L.func){L.func=p(L.url,L.line)}var x=r(L.url,L.line);var D=(x?x[Math.floor(x.length/2)]:null);if(x&&D.replace(/^\s*/,"")===u[H+1].replace(/^\s*/,"")){L.context=x}else{L.context=[u[H+1]]}B.push(L)}}if(!B.length){return null}return{mode:"multiline",name:K.name,message:u[0],stack:B}}function o(w,u,x,v){var t={url:u,line:x};if(t.url&&t.line){w.incomplete=false;if(!t.func){t.func=p(t.url,t.line)}if(!t.context){t.context=r(t.url,t.line)}var s=/ '([^']+)' /.exec(v);if(s){t.column=q(s[1],t.url,t.line)}if(w.stack.length>0){if(w.stack[0].url===t.url){if(w.stack[0].line===t.line){return false}else{if(!w.stack[0].line&&w.stack[0].func===t.func){w.stack[0].line=t.line;w.stack[0].context=t.context;return false}}}}w.stack.unshift(t);w.partial=true;return true}else{w.incomplete=true}return false}function d(z,x){var y=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,A=[],t={},v=false,w,B,s;for(var D=arguments.callee.caller;D&&!v;D=D.caller){if(D===h||D===TraceKit.report){continue}B={url:null,func:"?",line:null,column:null};if(D.name){B.func=D.name}else{if((w=y.exec(D.toString()))){B.func=w[1]}}if((s=l(D))){B.url=s.url;B.line=s.line;if(B.func==="?"){B.func=p(B.url,B.line)}var u=/ '([^']+)' /.exec(z.message||z.description);if(u){B.column=q(u[1],s.url,s.line)}}if(t[""+D]){B.recursion=true}A.push(B)}if(x){A.splice(0,x)}var C={mode:"callers",name:z.name,message:z.message,stack:A};o(C,z.sourceURL||z.fileName,z.line||z.lineNumber,z.message||z.description);return C}function h(t,v){var s=null;v=(v===undefined?0:+v);try{s=i(t);if(s){return s}}catch(u){if(k){throw u}}try{s=m(t);if(s){return s}}catch(u){if(k){throw u}}try{s=f(t);if(s){return s}}catch(u){if(k){throw u}}try{s=d(t,v+1);if(s){return s}}catch(u){if(k){throw u}}return{mode:"failed"}}function a(t){t=(t===undefined?0:+t)+1;try{(0)()}catch(s){return h(s,t+1)}return null}h.augmentStackTraceWithInitialElement=o;h.guessFunctionName=p;h.gatherContext=r;h.ofCaller=a;return h}());(function(a){var d=Array.prototype.slice,c=a.setTimeout;a.setTimeout=function(){var f=d.call(arguments,0),e=f[0];f[0]=function(){try{e.apply(this,arguments)}catch(g){TraceKit.report(g);throw g}};return c.apply(this,f)};var b=a.setInterval;a.setInterval=function(){var f=d.call(arguments,0),e=f[0];f[0]=function(){try{e.apply(this,arguments)}catch(g){TraceKit.report(g);throw g}};return b.apply(this,f)}}(window));(function(d){if(!d){return}var c=d.event.add;d.event.add=function(h,f,g,i){var e;if(g.handler){e=g.handler;g.handler=function(){try{return e.apply(this,arguments)}catch(j){TraceKit.report(j);throw j}}}else{e=g;g=function(){try{return e.apply(this,arguments)}catch(j){TraceKit.report(j);throw j}}}if(e.guid){g.guid=e.guid}else{g.guid=e.guid=d.guid++}return c.call(this,h,f,g,i)};var a=d.fn.ready;d.fn.ready=function(e){var f=function(){try{return e.apply(this,arguments)}catch(g){TraceKit.report(g);throw g}};return a.call(this,f)};var b=d.ajax;d.fn.ajax=function(i){if(d.isFunction(i.complete)){var g=i.complete;i.complete=function(){try{return g.apply(this,arguments)}catch(k){TraceKit.report(k);throw k}}}if(d.isFunction(i.error)){var f=i.error;i.error=function(){try{return f.apply(this,arguments)}catch(k){TraceKit.report(k);throw k}}}if(d.isFunction(i.success)){var h=i.success;i.success=function(){try{return h.apply(this,arguments)}catch(k){TraceKit.report(k);throw k}}}try{return b.call(this,i)}catch(j){TraceKit.report(j);throw j}}}(window.jQuery));
/*
 *
 * Bancha Project : Seamlessly integrates CakePHP with ExtJS and Sencha Touch (http://banchaproject.org)
 * Copyright 2011-2013 StudioQ OG
 *
 * @package       Bancha
 * @copyright     Copyright 2011-2013 StudioQ OG
 * @link          http://banchaproject.org Bancha Project
 * @since         Bancha v 0.0.2
 * @author        Roland Schuetz <mail@rolandschuetz.at>
 * @version       Bancha v 1.3.0
 *
 * For more information go to http://banchaproject.org
 */
Ext.define("Bancha.data.Model",{extend:"Ext.data.Model",forceConsistency:false});Ext.define("Bancha.data.writer.JsonWithDateTime",{extend:"Ext.data.writer.Json",alias:"writer.jsondate",getRecordData:function(b,e){var g=this.superclass.getRecordData.apply(this,arguments),d=this.nameProperty,a=b.fields,c=a.items,f=this;if(Ext.versions.touch){return g}if(parseInt(Ext.versions.extjs.shortVersion,10)>=411){Ext.each(c,function(i){var h=i[d]||i.name;if(i.type===Ext.data.Types.DATE&&i.dateFormat&&b.get(i.name)===null){g[h]=null}})}else{Ext.each(c,function(i){var h=i[d]||i.name;if(i.type===Ext.data.Types.DATE&&i.dateFormat){g[h]=f.writeDate(i,b.get(i.name))}})}return g},writeDate:function(c,b){var a=c.dateFormat||(c.getDateFormat?c.getDateFormat():false)||"timestamp";switch(a){case"timestamp":return b.getTime()/1000;case"time":return b.getTime();default:if(b===null||!Ext.isDefined(b)){return b}return Ext.Date.format(b,a)}}});Ext.define("Bancha.data.writer.ConsistentJson",{extend:"Bancha.data.writer.JsonWithDateTime",alias:"writer.consistent",uidProperty:"__bcid",model:undefined,writeRecords:function(a,b){if(this.model&&this.model.forceConsistency){if(this.encode){a.params[this.uidProperty]=Bancha.getConsistentUid()}else{a.jsonData[this.uidProperty]=Bancha.getConsistentUid()}}return this.superclass.writeRecords.apply(this,arguments)}});Ext.require(["Ext.data.validations"],function(){var a=function(b,d){if(!b){return true}if(!Ext.isDefined(d)){return true}var c=b.split(".").pop();return Ext.Array.contains(d,c)};Ext.apply(Ext.data.validations,{numberformatMessage:"is not a number or not in the allowed range",fileMessage:"is not a valid file",numberformat:function(b,c){if(typeof c!=="number"){c=(b.precision===0)?parseInt(c,10):parseFloat(c);if(typeof c!=="number"){return false}}if((Ext.isDefined(b.min)&&b.min>c)||(Ext.isDefined(b.max)&&c>b.max)){return false}return true},file:function(b,c){return a(c,b.extension)}})});if(!Array.prototype.reduce){Array.prototype.reduce=function reduce(b){if(this===null||this===undefined){throw new TypeError("Object is null or undefined")}var c=0,a=this.length>>0,d;if(typeof b!=="function"){throw new TypeError("First argument is not callable")}if(arguments.length<2){if(a===0){throw new TypeError("Array length is 0 and no second argument")}d=this[0];c=1}else{d=arguments[1]}while(c<a){if(c in this){d=b.call(undefined,d,this[c],c,this)}++c}return d}}Ext.define("Bancha",{singleton:true,requires:["Ext.data.*","Ext.direct.*","Ext.MessageBox"],REMOTE_API:window.Bancha?Bancha.REMOTE_API:undefined,version:"1.3.0",remoteApi:"Bancha.REMOTE_API",metaDataLoadFunction:"Bancha.loadMetaData",uidPropertyName:"_UID",namespace:null,modelNamespace:"Bancha.model",initialized:false,objectFromPath:function(c,f,b){if(typeof c==="number"){c=c+""}if(typeof c!=="string"){return undefined}b=(typeof b==="undefined")?true:b;if(!f){var d=c.indexOf("."),e,a;if(d===-1){return window[c]}e=c.slice(0,d);a=window[e];if(typeof a==="undefined"){return undefined}f=a;c=c.slice(d+1)}return c.split(".").reduce(function(h,g){if(h&&(b||h.hasOwnProperty(g))){return h[g]}},f)},getStubsNamespace:function(){return this.objectFromPath(this.namespace)},getStub:function(a){if(!Bancha.initialized){Bancha.init()}return Bancha.getStubsNamespace()[a]||undefined},getRemoteApi:function(){return this.objectFromPath(this.remoteApi)},init:function(){var e,g,c,b,f=false,h,d,a;c=Ext.Error.handle;Ext.Error.handle=function(i){Ext.Msg.alert("Bancha Error",i.msg)};if(Ext.versions.extjs&&!Ext.isReady){Ext.Error.raise({plugin:"Bancha",msg:"Bancha: Bancha should be initalized after the onReady event."})}if(!Ext.isObject(this.objectFromPath(this.remoteApi))){b=Ext.DomQuery.select("script");Ext.each(b,function(i){if(i.src&&(i.src.search(/bancha-api\.js/)!==-1||i.src.search(/bancha-api\/models\/([A-Za-z]*)\.js/)!==-1)){f=true;h=i.src}});if(!h){h="/bancha-api.js"}d=Ext.Ajax.request({url:h,async:false});if(!f){Ext.Error.raise({plugin:"Bancha",msg:["<b>Bancha Configuration Error:</b><br />","Please include the Bancha API before using Bancha by adding into your html:<br /><br />",d.status===200?"<i>&lt;script type=&quot;text/javascript&quot; src=&quot;/bancha-api.js&quot;&gt;&lt;/script&gt;</i>":"<i>&lt;script type=&quot;text/javascript&quot; src=&quot;path/to/your/webroot/bancha-api.js&quot;&gt;&lt;/script&gt;</i>"].join("")})}if(d.status===404){Ext.Error.raise({plugin:"Bancha",msg:["<b>Bancha Configuration Error:</b><br />",'You have an error in your <a href="'+h+'">Bancha API</a>, please fix it:<br /><br />',d.responseText.search(/<h2>Not Found<\/h2>/)!==-1?"<b>Note: You might have to turn ob debug mode to get a usefull error message!</b><br/><br/>":"",d.responseText.substr(0,31)==='<script type="text/javascript">'?d.responseText.substr(31,d.responseText.length-31-9):d.responseText].join("")})}if(d.responseText.search(/Parse error/)!==-1||d.responseText.search(/cake-error/)!==-1){Ext.Error.raise({plugin:"Bancha",msg:["<b>CakePHP Error:</b><br />","You have an php error in your code:<br /><br />",d.responseText.substr(0,31)==='<script type="text/javascript">'?d.responseText.substr(31,d.responseText.length-31-9):d.responseText].join("")})}Ext.Error.raise({plugin:"Bancha",msg:["<b>Unknown Error in Bancha API:</b><br />",'You have an error in your <a href="'+h+'">Bancha API</a>, please open the API for details.<br />',"Note: You might have to turn ob debug mode to get a usefull error message!<br />"].join("")})}if(this.initialized){Ext.Error.raise({plugin:"Bancha",msg:"Bancha: Bancha is initalized twice, please just initialize once."})}this.initialized=true;e=this.getRemoteApi();if(Bancha.getDebugLevel()===0&&window.TraceKit&&TraceKit.report&&Ext.isFunction(TraceKit.report.subscribe)){TraceKit.report.subscribe(function(i){Bancha.onError(i)})}if(!Ext.isDefined(e.metadata)){e.metadata={}}this.decodeMetadata(e);this.namespace=e.namespace||null;Ext.direct.Manager.addProvider(e);if(this.getDebugLevel()!==0){this.setupDebugErrorHandler()}},setupDebugErrorHandler:function(){},decodeMetadata:(function(){var a={Alpha:/^[a-zA-Z_]+$/,Alphanum:/^[a-zA-Z0-9_]+$/,Email:/^(\w+)([\-+.][\w]+)*@(\w[\-\w]*\.){1,5}([A-Za-z]){2,6}$/,Url:/(((^https?)|(^ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i};return function(b){Ext.Object.each(b.metadata,function(d,c){Ext.Object.each(c.validations,function(e,f){if(f.type==="format"&&Ext.isString(f.matcher)&&f.matcher.substr(0,6)==="bancha"&&a[f.matcher.substr(6)]){f.matcher=a[f.matcher.substr(6)]}})})}}()),preloadModelMetaData:function(b,e,d){var a,c=this.objectFromPath(this.metaDataLoadFunction,this.getStubsNamespace());if(Ext.isString(b)){b=[b]}a=function(f,g){Ext.apply(Bancha.getRemoteApi().metadata,f.data);this.decodeMetadata(Bancha.getRemoteApi());if(typeof e==="function"){if(!Ext.isDefined(d)){d=window}e.call(d,f.data)}};c(b,a,Bancha)},isRemoteModel:function(a){return(Ext.isObject(this.getStubsNamespace())&&Ext.isObject(this.getStubsNamespace()[a]))?true:false},modelMetaDataIsLoaded:function(a){var b=this.getRemoteApi();return(Ext.isObject(b)&&Ext.isObject(b.metadata)&&Ext.isObject(b.metadata[a]))?true:false},onModelReady:function(a,c,b){if(this.initialized){this.onInitializedOnModelReady(a,null,null,c,b)}else{Ext.onReady(function(){this.init();this.onInitializedOnModelReady(a,null,null,c,b)},this)}},onInitializedOnModelReady:function(d,b,h,g,c){var f=[],a,e=this;g=g||Ext.emptyFn;c=c||{};b=b||{};h=h||{};a=(d.length===1)?d[0]:d;if(Ext.isString(a)){if(this.modelMetaDataIsLoaded(a)){g.call(c,this.getModel(a))}else{this.preloadModelMetaData(a,function(){g.call(c,this.getModel(a))},this)}return}if(!Ext.isArray(d)){return false}Ext.Array.forEach(d,function(i){if(e.modelMetaDataIsLoaded(i)){h[i]=e.getModel(i)}else{f.push(i)}});Ext.each(b,function(i){if(e.modelMetaDataIsLoaded(i)){h[i]=e.getModel(i);return false}});if(f.length===0){g.call(c,h)}else{e.preloadModelMetaData(f,function(){e.onInitializedOnModelReady([],b,h,g,c)},e)}},getModelMetaData:function(a){if(this.modelMetaDataIsLoaded(a)){return Ext.clone(this.getRemoteApi().metadata[a])}return null},getConsistentUid:function(){var a=this.getRemoteApi();return(a&&a.metadata&&a.metadata[this.uidPropertyName])?a.metadata[this.uidPropertyName]:false},getDebugLevel:function(a){if(!this.initialized){return a}var b=this.getRemoteApi();return(b&&b.metadata&&Ext.isDefined(b.metadata._ServerDebugLevel))?b.metadata._ServerDebugLevel:a},log:function(e,d,c){d=d||"error";if(Bancha.getDebugLevel(0)===0||c){if(d==="info"){return}if(!Bancha.initialized){try{Bancha.init()}catch(b){Bancha.logToConsole(e,d);return}}var a=d==="missing_translation"?d:"js_error";e=(d==="warn"?"WARNING: ":"")+e;Bancha.getStub("Bancha").logError(e,a);return}Bancha.logToBrowser(e,d)},logToBrowser:function(b,a){a=a||"error";var c=a.replace(/_/," ").toUpperCase();if(window.console&&typeof window.console.log==="function"){Bancha.logToConsole(b,a)}else{Ext.Msg.alert(c,b)}},logToConsole:function(b,a){a=a||"error";var c=a.replace(/_/," ").toUpperCase();if(a==="error"&&typeof window.console.error==="function"){window.console.error(b);return}if((a==="warn"||a==="missing_translation")&&typeof window.console.warn==="function"){window.console.warn((a==="missing_translation"?"MISSING TRANSLATION: ":"")+b);return}if(a==="info"&&typeof window.console.info==="function"){window.console.info(b);return}window.console.log(c+": "+b)},onError:function(a){Bancha.log(Ext.encode(a),"error")},onRemoteException:function(c,b,a){Ext.MessageBox.show({title:"REMOTE EXCEPTION",msg:a.getError(),icon:Ext.MessageBox.ERROR,buttons:Ext.Msg.OK})},isCreatedModel:function(a){return Ext.ClassManager.isCreated(Bancha.modelNamespace+"."+a)},createModel:function(b,d){var a,f,e,c,g;if(!Bancha.initialized){Bancha.init()}if(!this.isRemoteModel(b)){return false}if(!this.modelMetaDataIsLoaded(b)){return false}if(Bancha.isCreatedModel(b)){return false}if(Ext.versions.touch){g={rootProperty:"data"}}else{g={root:"data"}}d=d||{};e=this.getStubsNamespace()[b];c=this.getModelMetaData(b).idProperty;f={extend:"Bancha.data.Model",idProperty:c,proxy:{type:"direct",batchActions:false,api:{read:e.read,create:e.create,update:e.update,destroy:e.destroy},directFn:e.read,reader:Ext.apply({type:"json",messageProperty:"message"},g),writer:(d.forceConsistency)?Ext.apply({type:"consitentjson",writeAllFields:false},g):Ext.apply({type:"jsondate",writeAllFields:false},g),listeners:{exception:this.onRemoteException||Ext.emptyFn}}};a=Ext.clone(this.getModelMetaData(b));d=Ext.apply(a,d,f);if(Ext.versions.touch){d={extend:d.extend,config:d};delete d.config.extend}Ext.define(Bancha.modelNamespace+"."+b,d);return true},getModel:function(a){if(!Bancha.initialized){Bancha.init()}return(this.isCreatedModel(a)||this.createModel(a))?Ext.ClassManager.get(Bancha.modelNamespace+"."+a):null},Localizer:{currentLang:"eng",getCurrentLanguage:function(){return this.currentLang},setCurrentLanguage:function(a){this.currentLang=a},preloadLanguage:function(a){if(!this.locales){this.locales=new Ext.util.HashMap()}this.loadLocaleStrings(a||this.currentLang,true)},loadLocaleStrings:function(a,c){var d=this,b;Ext.Ajax.request({url:"/bancha/bancha/translations/"+a+".js",async:c||false,success:function(f){var e=Ext.decode(f.responseText);b=new Ext.util.HashMap();Ext.each(e,function(g){b.add(g.key,g.value)});d.locales.add(a,b)},failure:function(){d.locales.add(a,false);b=false}});return b},getLocaleStrings:function(a){var c=this,b;if(!c.locales){c.locales=new Ext.util.HashMap()}if(!c.locales.get(a)){b=c.loadLocaleStrings(a)}else{b=c.locales.get(a)}if(Ext.isBoolean(b)&&!b){return}return b},getLocalizedString:function(d,a){var e=this,c,b;d=d+"";a=a||this.currentLang;if(!d||!a){return d}c=e.getLocaleStrings(a);if(!c){return d}b=c.get(d);if(!Ext.isString(b)){return d}return b},getLocalizedStringWithReplacements:function(g,d,c,a){g=this.getLocalizedString(g);var h=g.split("%"),j=h[0],e,f,b;for(e=1,f=h.length;e<f;e++){switch(h[e].substr(0,1)){case"d":j+=parseInt(arguments[e],10);break;case"s":j+=arguments[e];break;default:j+="%"+h[e].substr(0,1)}j+=h[e].substr(1)}return j}},t:function(c,d,b,a){return Bancha.Localizer.getLocalizedStringWithReplacements.apply(Bancha.Localizer,arguments)}});Ext.require(["Bancha"],function(){Bancha.log.info=function(b,a){Bancha.log(b,"info",a||false)};Bancha.log.warn=function(b,a){Bancha.log(b,"warn",a||false)};Bancha.log.error=function(b,a){Bancha.log(b,"error",a||false)}});